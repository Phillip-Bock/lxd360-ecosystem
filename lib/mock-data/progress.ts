/**
 * Mock progress and enrollment data for LXP360
 */

import type {
  CourseProgress,
  Enrollment,
  LearningGoal,
  LessonProgress,
  RecentlyViewed,
  SavedCourse,
} from '@/types/lms';

export const mockEnrollments: Enrollment[] = [
  {
    id: 'enroll-001',
    learnerId: 'learner-001',
    courseId: 'course-001',
    status: 'completed',
    source: 'self',
    enrolledAt: '2024-06-15T10:00:00Z',
    startedAt: '2024-06-15T10:30:00Z',
    completedAt: '2024-09-15T16:45:00Z',
    progress: 100,
    lessonsCompleted: 42,
    lessonsTotal: 42,
    quizzesCompleted: 8,
    quizzesTotal: 8,
    timeSpent: 485,
    lastAccessedAt: '2024-09-15T16:45:00Z',
    averageQuizScore: 92,
    finalScore: 92,
    certificateId: 'cert-001',
    certificateIssuedAt: '2024-09-15T16:45:00Z',
    isRequired: false,
    registration: 'reg-001-001',
  },
  {
    id: 'enroll-002',
    learnerId: 'learner-001',
    courseId: 'course-002',
    status: 'in-progress',
    source: 'self',
    enrolledAt: '2024-10-01T09:00:00Z',
    startedAt: '2024-10-01T09:15:00Z',
    progress: 65,
    lessonsCompleted: 36,
    lessonsTotal: 56,
    quizzesCompleted: 6,
    quizzesTotal: 10,
    timeSpent: 425,
    lastAccessedAt: '2024-12-08T14:30:00Z',
    averageQuizScore: 88,
    isRequired: false,
    registration: 'reg-001-002',
  },
  {
    id: 'enroll-003',
    learnerId: 'learner-001',
    courseId: 'course-003',
    status: 'completed',
    source: 'compliance',
    assignedBy: 'system',
    assignedAt: '2024-10-15T08:00:00Z',
    enrolledAt: '2024-10-15T08:00:00Z',
    startedAt: '2024-10-28T10:00:00Z',
    completedAt: '2024-11-01T10:30:00Z',
    dueDate: '2024-11-15T23:59:59Z',
    progress: 100,
    lessonsCompleted: 18,
    lessonsTotal: 18,
    quizzesCompleted: 4,
    quizzesTotal: 4,
    timeSpent: 95,
    lastAccessedAt: '2024-11-01T10:30:00Z',
    averageQuizScore: 88,
    finalScore: 88,
    certificateId: 'cert-002',
    certificateIssuedAt: '2024-11-01T10:30:00Z',
    isRequired: true,
    complianceDeadline: '2024-11-15T23:59:59Z',
    registration: 'reg-001-003',
  },
  {
    id: 'enroll-004',
    learnerId: 'learner-001',
    courseId: 'course-007',
    status: 'completed',
    source: 'compliance',
    assignedBy: 'system',
    assignedAt: '2024-01-01T00:00:00Z',
    enrolledAt: '2024-01-15T09:00:00Z',
    startedAt: '2024-01-15T09:30:00Z',
    completedAt: '2024-01-15T11:00:00Z',
    dueDate: '2024-01-31T23:59:59Z',
    progress: 100,
    lessonsCompleted: 12,
    lessonsTotal: 12,
    quizzesCompleted: 3,
    quizzesTotal: 3,
    timeSpent: 62,
    lastAccessedAt: '2024-01-15T11:00:00Z',
    averageQuizScore: 95,
    finalScore: 95,
    isRequired: true,
    complianceDeadline: '2024-01-31T23:59:59Z',
    registration: 'reg-001-007',
  },
  {
    id: 'enroll-005',
    learnerId: 'learner-001',
    courseId: 'course-005',
    status: 'in-progress',
    source: 'self',
    enrolledAt: '2024-11-01T14:00:00Z',
    startedAt: '2024-11-05T10:00:00Z',
    progress: 25,
    lessonsCompleted: 10,
    lessonsTotal: 38,
    quizzesCompleted: 1,
    quizzesTotal: 6,
    timeSpent: 95,
    lastAccessedAt: '2024-12-05T16:30:00Z',
    averageQuizScore: 85,
    isRequired: false,
    registration: 'reg-001-005',
  },
  {
    id: 'enroll-006',
    learnerId: 'learner-001',
    courseId: 'course-006',
    status: 'enrolled',
    source: 'self',
    enrolledAt: '2024-12-01T08:00:00Z',
    progress: 0,
    lessonsCompleted: 0,
    lessonsTotal: 48,
    quizzesCompleted: 0,
    quizzesTotal: 9,
    timeSpent: 0,
    isRequired: false,
    registration: 'reg-001-006',
  },
  // Learner 2 enrollments
  {
    id: 'enroll-007',
    learnerId: 'learner-002',
    courseId: 'course-005',
    status: 'in-progress',
    source: 'manager',
    assignedBy: 'manager-002',
    assignedAt: '2024-09-01T08:00:00Z',
    enrolledAt: '2024-09-01T08:00:00Z',
    startedAt: '2024-09-05T10:00:00Z',
    dueDate: '2024-12-31T23:59:59Z',
    progress: 60,
    lessonsCompleted: 23,
    lessonsTotal: 38,
    quizzesCompleted: 4,
    quizzesTotal: 6,
    timeSpent: 210,
    lastAccessedAt: '2024-12-07T16:45:00Z',
    averageQuizScore: 82,
    isRequired: true,
    registration: 'reg-002-005',
  },
];

export const mockLessonProgress: LessonProgress[] = [
  {
    id: 'lp-001',
    enrollmentId: 'enroll-002',
    lessonId: 'course-002-module-1-lesson-1',
    learnerId: 'learner-001',
    status: 'completed',
    progress: 100,
    timeSpent: 1250,
    startedAt: '2024-10-01T09:15:00Z',
    completedAt: '2024-10-01T09:35:00Z',
    lastPosition: 1250,
    attempts: 1,
    xapiStatements: 15,
  },
  {
    id: 'lp-002',
    enrollmentId: 'enroll-002',
    lessonId: 'course-002-module-2-lesson-3',
    learnerId: 'learner-001',
    status: 'in-progress',
    progress: 72,
    timeSpent: 850,
    startedAt: '2024-12-08T14:00:00Z',
    lastPosition: 850,
    attempts: 1,
    xapiStatements: 8,
  },
];

export const mockCourseProgress: CourseProgress[] = [
  {
    enrollmentId: 'enroll-002',
    courseId: 'course-002',
    learnerId: 'learner-001',
    overallProgress: 65,
    moduleProgress: [
      {
        moduleId: 'course-002-module-1',
        enrollmentId: 'enroll-002',
        status: 'completed',
        progress: 100,
        lessonsCompleted: 5,
        lessonsTotal: 5,
        timeSpent: 4500,
        startedAt: '2024-10-01T09:15:00Z',
        completedAt: '2024-10-08T15:30:00Z',
      },
      {
        moduleId: 'course-002-module-2',
        enrollmentId: 'enroll-002',
        status: 'completed',
        progress: 100,
        lessonsCompleted: 6,
        lessonsTotal: 6,
        timeSpent: 5200,
        startedAt: '2024-10-10T10:00:00Z',
        completedAt: '2024-10-20T14:00:00Z',
      },
      {
        moduleId: 'course-002-module-3',
        enrollmentId: 'enroll-002',
        status: 'completed',
        progress: 100,
        lessonsCompleted: 8,
        lessonsTotal: 8,
        timeSpent: 6800,
        startedAt: '2024-10-22T09:00:00Z',
        completedAt: '2024-11-05T16:30:00Z',
      },
      {
        moduleId: 'course-002-module-4',
        enrollmentId: 'enroll-002',
        status: 'in-progress',
        progress: 70,
        lessonsCompleted: 7,
        lessonsTotal: 10,
        timeSpent: 4200,
        startedAt: '2024-11-08T10:00:00Z',
      },
      {
        moduleId: 'course-002-module-5',
        enrollmentId: 'enroll-002',
        status: 'available',
        progress: 40,
        lessonsCompleted: 4,
        lessonsTotal: 10,
        timeSpent: 2400,
        startedAt: '2024-12-01T09:00:00Z',
      },
      {
        moduleId: 'course-002-module-6',
        enrollmentId: 'enroll-002',
        status: 'locked',
        progress: 0,
        lessonsCompleted: 0,
        lessonsTotal: 12,
        timeSpent: 0,
      },
    ],
    lessonProgress: mockLessonProgress,
    quizAttempts: [
      {
        quizId: 'quiz-002-1',
        quizTitle: 'React Basics Quiz',
        attempts: 1,
        bestScore: 95,
        latestScore: 95,
        averageScore: 95,
        passed: true,
        passedAt: '2024-10-08T15:30:00Z',
        totalTimeSpent: 1200,
      },
      {
        quizId: 'quiz-002-2',
        quizTitle: 'State Management Quiz',
        attempts: 2,
        bestScore: 90,
        latestScore: 90,
        averageScore: 82,
        passed: true,
        passedAt: '2024-10-20T14:00:00Z',
        totalTimeSpent: 2400,
      },
      {
        quizId: 'quiz-002-3',
        quizTitle: 'Hooks Deep Dive Quiz',
        attempts: 1,
        bestScore: 88,
        latestScore: 88,
        averageScore: 88,
        passed: true,
        passedAt: '2024-11-05T16:30:00Z',
        totalTimeSpent: 1800,
      },
    ],
    timeSpent: 25500,
    sessionsCount: 28,
    averageSessionLength: 55,
    lastActivityAt: '2024-12-08T14:30:00Z',
    estimatedCompletionDate: '2024-12-25T00:00:00Z',
    currentStreak: 3,
    longestStreak: 12,
    lastActivityDate: '2024-12-08',
    xpEarned: 2450,
    xpPossible: 3500,
  },
];

export const mockLearningGoals: LearningGoal[] = [
  {
    id: 'goal-001',
    learnerId: 'learner-001',
    type: 'daily',
    metric: 'minutes',
    target: 30,
    current: 45,
    startDate: '2024-12-08T00:00:00Z',
    endDate: '2024-12-08T23:59:59Z',
    status: 'achieved',
    streak: 15,
    notifyOnCompletion: true,
  },
  {
    id: 'goal-002',
    learnerId: 'learner-001',
    type: 'weekly',
    metric: 'lessons',
    target: 10,
    current: 7,
    startDate: '2024-12-02T00:00:00Z',
    endDate: '2024-12-08T23:59:59Z',
    status: 'active',
    streak: 4,
    notifyOnCompletion: true,
  },
  {
    id: 'goal-003',
    learnerId: 'learner-001',
    type: 'monthly',
    metric: 'courses',
    target: 2,
    current: 1,
    startDate: '2024-12-01T00:00:00Z',
    endDate: '2024-12-31T23:59:59Z',
    status: 'active',
    streak: 3,
    notifyOnCompletion: true,
  },
];

export const mockSavedCourses: SavedCourse[] = [
  {
    id: 'saved-001',
    learnerId: 'learner-001',
    courseId: 'course-009',
    savedAt: '2024-11-15T10:00:00Z',
    notes: 'Want to take this after completing React course',
  },
  {
    id: 'saved-002',
    learnerId: 'learner-001',
    courseId: 'course-008',
    savedAt: '2024-10-20T14:30:00Z',
  },
];

export const mockRecentlyViewed: RecentlyViewed[] = [
  {
    id: 'recent-001',
    learnerId: 'learner-001',
    resourceType: 'course',
    resourceId: 'course-002',
    viewedAt: '2024-12-08T14:30:00Z',
    duration: 2700,
  },
  {
    id: 'recent-002',
    learnerId: 'learner-001',
    resourceType: 'lesson',
    resourceId: 'course-002-module-4-lesson-7',
    viewedAt: '2024-12-08T14:00:00Z',
    duration: 1800,
  },
  {
    id: 'recent-003',
    learnerId: 'learner-001',
    resourceType: 'course',
    resourceId: 'course-005',
    viewedAt: '2024-12-05T16:30:00Z',
    duration: 3600,
  },
  {
    id: 'recent-004',
    learnerId: 'learner-001',
    resourceType: 'path',
    resourceId: 'path-001',
    viewedAt: '2024-12-03T09:00:00Z',
    duration: 600,
  },
];

// Helper functions
export function getEnrollmentsForLearner(learnerId: string): Enrollment[] {
  return mockEnrollments.filter((e) => e.learnerId === learnerId);
}

export function getInProgressEnrollments(learnerId: string): Enrollment[] {
  return mockEnrollments.filter((e) => e.learnerId === learnerId && e.status === 'in-progress');
}

export function getCompletedEnrollments(learnerId: string): Enrollment[] {
  return mockEnrollments.filter((e) => e.learnerId === learnerId && e.status === 'completed');
}

export function getEnrollmentByCourse(learnerId: string, courseId: string): Enrollment | undefined {
  return mockEnrollments.find((e) => e.learnerId === learnerId && e.courseId === courseId);
}

export function calculateLearnerStats(learnerId: string) {
  const enrollments = getEnrollmentsForLearner(learnerId);
  const completed = enrollments.filter((e) => e.status === 'completed');
  const inProgress = enrollments.filter((e) => e.status === 'in-progress');
  const totalTimeSpent = enrollments.reduce((sum, e) => sum + e.timeSpent, 0);

  return {
    totalEnrollments: enrollments.length,
    completed: completed.length,
    inProgress: inProgress.length,
    completionRate:
      enrollments.length > 0 ? Math.round((completed.length / enrollments.length) * 100) : 0,
    totalTimeSpent,
    averageScore: Math.round(
      completed.reduce((sum, e) => sum + (e.finalScore || 0), 0) / (completed.length || 1),
    ),
  };
}
